<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>浏览器工作原理笔记</title>
<style>
  body { font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; }
  h1 { color: #2c3e50; }
  h2 { color: #34495e; margin-top: 20px; }
  pre { background: #f4f4f4; padding: 10px; border-left: 4px solid #3498db; overflow-x: auto; }
  ul { margin-bottom: 10px; }
</style>
</head>
<body>

<h1>浏览器工作原理笔记</h1>

<h2>1. DNS 解析</h2>
<ul>
  <li>>  浏览器通过 DNS 查询域名对应的 IP 地址。</li>
  <li>>  会优先检查本地缓存，缓存没有再请求 DNS 服务器。</li>
</ul>

<h2>2. 建立 TCP/HTTPS 连接</h2>
<ul>
  <li>></li> 浏览器通过 IP 建立 TCP 连接（三次握手）。</li>
  <li>></li> 如果是 HTTPS，还会进行 TLS/SSL 握手，验证身份并协商加密算法。</li>
</ul>

<h2>3. 发送 HTTP 请求</h2>
<pre>
GET /index.html HTTP/1.1
Host: example.com
User-Agent: 浏览器类型
Accept: text/html
</pre>

<h2>4. 服务器响应</h2>
<pre>
HTTP/1.1 200 OK
Content-Type: text/html; charset=UTF-8
Content-Length: 1024
</pre>
<p>浏览器开始下载 HTML 文件。</p>

<h2>5. HTML 解析 & DOM 构建</h2>
<ul>
  <li> 解析 HTML 标签，构建 <strong>DOM 树</strong>。</li>
  <li> 遇到 <code>&lt;link&gt;</code>、<code>&lt;style&gt;</code>、<code>&lt;script&gt;</code> 时，会下载/执行 CSS 和 JS。</li>
</ul>

<h2>6. CSS 解析 & CSSOM 构建</h2>
<ul>
  <li>>  CSS 解析生成 <strong>CSSOM 树</strong>。</li>
  <li>>  CSSOM 和 DOM 合并生成 <strong>渲染树（Render Tree）</strong>，只包含可见节点。</li>
</ul>

<h2>7. 布局（Layout / Reflow）</h2>
<ul>
  <li>>  根据渲染树计算每个节点的尺寸和位置。</li>
  <li>>  是网页排版的核心阶段。</li>
</ul>

<h2>8. 绘制（Painting）</h2>
<ul>
  <li>> 浏览器将节点绘制到图层（Layer），生成位图准备显示。</li>
</ul>

<h2>9. 合成（Compositing）</h2>
<ul>
  <li> 对有独立图层的元素进行合成，GPU 渲染到屏幕。</li>
</ul>

<h2>10. JS 和重排重绘</h2>
<ul>
  <li> JS 修改 DOM 或 CSS 可能触发 <strong>重排（Reflow）</strong> 或 <strong>重绘（Repaint）</strong>。</li>
  <li> CSS 动画或 JS 动画会触发图层合成更新。</li>
</ul>

<h2>浏览器渲染流程图</h2>
<pre>
输入 URL
   ↓
DNS 解析 → TCP/HTTPS 连接 → 发送 HTTP 请求
   ↓
接收 HTTP 响应 → 下载 HTML
   ↓
解析 HTML → 构建 DOM
   ↓
解析 CSS → 构建 CSSOM → 生成渲染树
   ↓
布局（Layout / Reflow）
   ↓
绘制（Painting）
   ↓
合成（Compositing） → 屏幕显示
</pre>

<h2>性能优化建议</h2>
<ul>
  <li> 减少重排（Reflow）和重绘（Repaint）。</li>
  <li> 异步加载 JS 和 CSS。</li>
  <li> 使用 GPU 加速动画。</li>
  <li> 合理使用缓存和压缩资源。</li>
</ul>

</body>
</html>
